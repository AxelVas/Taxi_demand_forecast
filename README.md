## Прогноз спроса на такси
![image](https://user-images.githubusercontent.com/76148212/122681168-c3636680-d1fb-11eb-8257-93c4ebe1f7ae.png)


## Описание проекта
Компания «Чётенькое такси» собрала исторические данные о заказах такси в аэропортах. Чтобы привлекать больше водителей в период пиковой нагрузки, нужно спрогнозировать количество заказов такси на следующий час. Постройте модель для такого предсказания.
Значение метрики RMSE на тестовой выборке должно быть не больше 48.

## Кртакое описание проведённой работы:
> Проанализированы исторические данные о заказах такси в аэропортах.  
Спрогнозировано количество заказов такси на следующий час, чтобы привлекать больше водителей в период пиковой нагрузки
Построена модель для такого предсказания.
Достигнуто значение метрики RMSE на тестовой выборке меньше 48.

## Стэк:
`Pandas`
`sklearn`
`numpy`
`LightGBM`
`Matplotlib`
`StatsModels`
`CatBoost`
`машинное обучение`

## Полное содержание проекта:
## Подготовка данных
   * <a href='#step_1'> Загружаем библиотеки </a>
   * <a href='#step_1.1'> Откроем файл и изучим его </a>
          - Путь к файлу: (/datasets/taxi.csv)
   * <a href='#step_1.2'>Посмотрим на распределение данных в таблице</a>
   * <a href='#step_1.3'>Выполним ресемплирование наших данных по одному часу</a>
   * <a href='#step_1.4'>Приведём в целочисленный формат количество заказов</a>
   * <a href='#step_1.end'> Вывод </a>

## Анализ
   * <a href='#step_2'> Построим график распределения количества заказов в час за весь период </a>
   * <a href='#step_2.1'> Определим тренд </a>
   * <a href='#step_2.2'> Определим сезонность</a>
   * <a href='#step_2.3'>Остаток декомпозиции</a>
   * <a href='#step_2.4'> Для более качествоенного предсказания моделей оценим распределение даных и отсортируем (шумные)выбивающиеся значения </a>
  
   * <a href='#step_2.end'> Вывод </a>   
      
## Обучение
   * <a href='#step_3'> Создадим функцию для добавления в нашу выборку признаков и отстающего значения для удобства подбора параметров моделей </a>
   * <a href='#step_3.1'>  Определим тестовую и тренировочную выборку </a>
   
   
   * <a href='#step_3.2'>Для расчёта целевой метрики используем RMSE и напишем функцию для её расчёта</a>
   * <a href='#step_3.3'> Создадим функцию, которая будет принимать на вход целевые и предсказанные значения, а возвращать абсолютное и среднеквадратичное отклонение на графиках с визуальным распределением разброса целевых признаков  </a>
  
   * <a href='#step_3.4'> Проверим предсказания модели `LinearRegression` </a>
   * <a href='#step_3.5'> Проверим предсказания модели `RandomForestRegressor`</a>
   * <a href='#step_3.6'> Проверим предсказания модели `CatBoostRegressor` </a>

   * <a href='#step_3.end'> Вывод </a> 
   
## Анализ работы моделей на тестовых данных   
   * <a href='#step_4'>Для наглядности сведём $RMSE$ и $MAE$ в таблицу</a>
   * <a href='#step_4.1'>Проведём анализ остатков по предсказаниям моделей</a>
   * <a href='#step_4.2'>Составим сводную таблицу по среднему значению отклонения предсказанных от истинных значений с разбивкой на дни недели</a>
   * <a href='#step_4.3'>Для наглядности отобразим отклонения на графике</a>
   * <a href='#step_4.4'>Проверим предсказания нашей наилучшей модели</a>
   * <a href='#step_4.5'>Посмотрим значения предсказания наилучшей модели на графиках и сравним с целевыми</a>
       * <a href='#step_4.6'>Построим график за целевой период времени и нанесём на него скользящие средние значения</a>
       * <a href='#step_4.7'>График цикличный и повторяется ежедневно, возьмём период по дням недели</a>
       * <a href='#step_4.8'>Посмотрим на  временной период одного дня с распределением по часам и на предсказания нашей лучшей модели</a>
   * <a href='#step_4.end'> Вывод </a>
   

## Общий вывод
   * <a href='#step_5.end'> Вывод </a>

<font color='orange'><u>INFO</u>:<font color='gray'> При запуске ячеек, запустить <font color='green'><i>"Restart & Run All"



